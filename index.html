<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caja de Herramientas Matemáticas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; display: flex; }
        #sidebar { width: 250px; background-color: #f0f0f0; padding: 20px; height: 100vh; }
        #content { flex-grow: 1; padding: 20px; }
        .tool-container { background-color: #fff; border: 1px solid #ddd; border-radius: 5px; padding: 20px; margin-top: 20px; }
        .matrix-input input { width: 80px; margin: 2px; }
        .gj-history { max-height: 200px; overflow-y: auto; }
        .gj-card { margin-bottom: 1rem; }
        .gj-matrix { font-size: 0.9em; white-space: pre-wrap; }
        .btn-primary { background-color: #79aec8; border-color: #79aec8; }
        .btn-primary:hover { background-color: #5a9bc2; }

        /* Estilos para la herramienta de determinantes */
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #103db9;
            --warning-color: #f59e0b;
            --border-color: #e5e7eb;
            --background-color: #f3f4f6;
        }

        .container { max-width: 1200px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: 1fr 1.3fr; gap: 20px; margin-top: 20px; }
        .card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .title { font-size: 1.8rem; font-weight: bold; text-align: center; margin-bottom: 2rem; color: #1f2937; }
        .subtitle { font-size: 1.25rem; font-weight: bold; margin: 1rem 0; color: #374151; }
        .matrix-grid { display: grid; gap: 0.5rem; margin: 1rem 0; }
        .matrix-row { display: grid; grid-template-columns: repeat(var(--matrix-size), 1fr); gap: 0.5rem; }
        .matrix-cell { position: relative; min-width: 80px; }
        .number-input { width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; text-align: center; font-size: 1rem; }
        .button { display: inline-block; padding: 0.75rem 1rem; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.2s; text-align: center; width: 100%; margin: 0.5rem 0; color: white; }
        .button-primary { background-color: var(--primary-color); }
        .button-primary:hover { background-color: #2563eb; }
        .button-secondary { background-color: var(--secondary-color); }
        .button-secondary:hover { background-color: #364483; }
        .button-warning { background-color: var(--warning-color); }
        .button-warning:hover { background-color: #d97706; }
        .process-section { margin-top: 20px; padding: 15px; background-color: #f8fafc; border-radius: 8px; border: 1px solid var(--border-color); }
        .latex-process { margin: 10px 0; padding: 15px; background-color: white; border-radius: 4px; min-height: 200px; overflow-x: auto; border: 1px solid var(--border-color); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .operations-box { padding: 15px; background-color: #f8fafc; border-radius: 8px; margin: 1rem 0; border: 1px solid var(--border-color); }
        .operation-selector { width: 100%; padding: 0.5rem; margin-bottom: 1rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 1rem; }
        .operation-inputs { margin-bottom: 1rem; }
        .info-section { margin-top: 1rem; padding: 1rem; background-color: #f0f7ff; border-radius: 4px; border-left: 4px solid var(--primary-color); }
        .properties-section { margin-top: 1rem; padding: 1rem; background-color: #f0f7ff; border-radius: 4px; }
        .property-item { margin-bottom: 0.5rem; padding: 0.5rem; border-left: 3px solid var(--primary-color); }
        .button:disabled { background-color: #ccc; cursor: not-allowed; }
        #sidebar button {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            background: var(--secondary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        #sidebar button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div id="sidebar">
        <h2>Caja de Herramientas para algebra lineal</h2>
        <ul>
            <li><button onclick="app.loadTool('introduccion1')">Introducción</button></li>
            <!-- <li><button onclick="app.loadTool('determinantes2')">Cálculo de Matrices2</button></li> -->
            <li><button onclick="app.loadTool('determinantes3')">Suma de matrices</button></li>
            <li><button onclick="app.loadTool('determinantes4')">Producto de matrices</button></li>
            <li><button onclick="app.loadTool('algebraLineal')">Cálculo para sistemas de ecuaciones</button></li>
            <li><button onclick="app.loadTool('determinantes')">Cálculo para Determinantes</button></li>
            <li><button onclick="app.loadTool('determinantes5')">Potencia de una matriz</button></li>
            <!-- Más herramientas pueden agregarse aquí -->
        </ul>
    </div>

    <div id="content">
        <div id="tool-content" class="tool-container"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const app = {
            loadTool: function(tool) {
                const toolContent = document.getElementById('tool-content');
                let content = '';
                
                if(tool === 'algebraLineal') {
                    content = `
                    <h2 class="mb-4">Álgebra Lineal - Método Gauss-Jordan</h2>
                    <div class="row">
                        <div class="col-md-4">
                            ${this.gaussJordanSidebar()}
                        </div>
                        <div class="col-md-8">
                            ${this.gaussJordanMainPanel()}
                        </div>
                    </div>
                `;
                
            
                } else if(tool === 'introduccion1') {
                    content = `
                    <h3>Introducción a la Caja de Herramientas</h3>
                        <p> 
                        </p>
                        <p>Hace algún tiempo el profesor Carlos Andrés Escobar Guerra propuso la creación de unas cartillas para los cursos de matemáticas de la facultad de Ciencias y Biotecnología, la elaboración de las cartillas produjo la necesidad de tener las herramientas para desarrollar las actividades de dicha cartilla.</p>
                        <p> 
                        </p>
                        <p> 
                        </p>
                        <p>Así es que se llegó a la creación de una caja de herramientas donde se encontraran aplicaciones de aritmética, matemáticas I, II y III, y aplicaciones más avanzadas, la caja de herramientas hace más dinámica la clase, hace que los estudiantes adquieran los saberes esenciales más rápidamente, depende del profesor y de los estudiantes no pasar por alto los detalles que conducen a la solución.</p>
                        <p></p>
                        <p></p>
                        <p>Para solucionar muchos de los ejercicios y problemas no es necesario ser un gran estudiante en matemáticas, eso sí, debe saber interiorizar, entender los conceptos que ayudan a solucionar el problema y en la caja de herramientas encontrará los instrumentos que le ayudaran a solucionar los problemas; depende del alumno escoger la herramienta adecuada.</p>
                        <p></p>
                        <p></p>
                        <p>Otra ventaja de la caja de herramientas es que las aplicaciones se pueden encontrar en un sólo espacio virtual y diseñadas de acuerdo a las necesidades de nuestros estudiantes, para la construcción de las herramientas se utilizó R, LaTeX, Flexdashboard, Bookdown, Shiny, y Geogebra.</p>
                        <p></p>
                        <p></p>
                        <p>Se puede decir que el equipo de trabajo está conformado por el profesor Carlos Andrés Escobar Guerra, Pablo Andrés Guzmán, John Jairo Estrada Álvarez y Juan Albero Arias Quiceno. Gracias a la invaluable ayuda del profesor de estadística y programación Pablo Andrés Guzmán puesto que él inspiró la creación de un grupo de estudio en el cual compartía sus conocimientos de R, de otros programas y actualmente da su opinión acerca de las nuevas aplicaciones. John Jairo Estrada, el cerebro del proyecto, es el programador de todas las aplicaciones.</p>
                
                `;
                }

                else if(tool === 'determinantes2') {
                    content = `
                       

                `;
                }

                else if(tool === 'determinantes3') {
                    content = `

                      
                            <h1 class="mb-4">Suma de Matrices con Escalares</h1>
                            <div class="input-group">
                                <div class="input-field">
                                    <label class="form-label">Filas:</label>
                                    <input type="number" id="rows" class="form-control" placeholder="Filas" min="1" value="2">
                                </div>
                                <div class="input-field">
                                    <label class="form-label">Columnas:</label>
                                    <input type="number" id="cols" class="form-control" placeholder="Columnas" min="1" value="2">
                                </div>
                                <button class="btn btn-primary" onclick="generateMatrixInputs1()">Generar Matrices</button>
                            </div>

                            <div id="matrix-inputs" class="matrix-container"></div>

                            <div class="input-group">
                                <div class="input-field">
                                    <label class="form-label">Escalar para A:</label>
                                    <input type="number" id="scalarA" class="scalar-input" value="1">
                                </div>
                                <div class="input-field">
                                    <label class="form-label">Escalar para B:</label>
                                    <input type="number" id="scalarB" class="scalar-input" value="1">
                                </div>
                            </div>

                            <button class="btn btn-primary" onclick="calculateSum()">Calcular Suma</button>

                            <div class="latex-output">
                                <strong>Resultado:</strong>
                                <div id="matrix-result-latex"></div>
                            </div>   
                
                `;
                }

                else if(tool === 'determinantes4') {
                    content = `

                        <!-- Sección Multiplicación de Matrices -->
                    <div class="input-group">
                         <div class="input-group">
                            <div id="matrices" class="section">
                                <h2>Multiplicación de Matrices</h2>
                                <div class="input-field">
                                    <label>Filas (A):</label>
                                    <input type="number" id="rowsA" placeholder="Filas de A">
                                </div>
                                <div class="input-field">
                                    <label>Columnas (A):</label>
                                    <input type="number" id="colsA" placeholder="Columnas de A">
                                </div>
                                <div class="input-field">
                                    <label>Filas (B):</label>
                                    <input type="number" id="rowsB" placeholder="Filas de B">
                                </div>
                                <div class="input-field">
                                    <label>Columnas (B):</label>
                                    <input type="number" id="colsB" placeholder="Columnas de B">
                                </div>
                                <button class="btn btn-primary" onclick="generateMatrixInputs()">Generar Matrices</button>
                                <div id="matrix-inputs"></div>
                                <button class="btn btn-primary" onclick="calculateProduct()">Calcular Producto</button>
                                <div class="latex-output">
                                    <strong>Desarrollo del producto:</strong>
                                    <div id="matrix-product-latex"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                            
                  `;
                }
                
                
                else if(tool === 'determinantes') {
                    content = `
                        <h2 class="mb-4">Cálculo de Determinantes</h2>
                        <div class="container">
                            <div class="grid">
                                <!-- Dimensión y Configuración -->
                                <div class="card">
                                    <h2 class="subtitle">Dimensión de la Matriz</h2>
                                    <div class="input-group">
                                        <label for="matrixSize">Tamaño de la matriz cuadrada:</label>
                                        <input type="number" id="matrixSize" class="number-input" min="2" max="5" value="2">
                                        <button class="button button-primary" onclick="updateSize()">Generar Matriz</button>
                                        <button class="button button-warning" onclick="resetMatrix()">Reiniciar Matriz</button>
                                    </div>

                                    <div class="properties-section">
                                        <h3 class="subtitle">Propiedades de las Operaciones</h3>
                                        <div class="property-item">
                                            <strong>1. Intercambiar Filas (F<sub>i</sub> ↔ F<sub>j</sub>):</strong>
                                            <p>El determinante cambia de signo: det(A) = -det(A)</p>
                                        </div>
                                        <div class="property-item">
                                            <strong>2. Multiplicar Fila (kF<sub>i</sub>):</strong>
                                            <p>El determinante se multiplica por k: det(A) = k·det(A)</p>
                                        </div>
                                        <div class="property-item">
                                            <strong>3. Sumar Múltiplo (F<sub>i</sub> + kF<sub>j</sub>):</strong>
                                            <p>El determinante no cambia</p>
                                        </div>
                                    </div>

                                    <div class="info-section">
                                        <h3>Instrucciones</h3>
                                        <p>Puede ingresar números como:</p>
                                        <ul>
                                            <li>Enteros: 5</li>
                                            <li>Decimales: 2.5</li>
                                            <li>Fracciones: 1/2</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- Matriz y Operaciones -->
                                <div class="card">
                                    <h2 class="subtitle">Matriz</h2>
                                    <div id="matrixInput" class="matrix-grid"></div>
                                    <button class="button button-primary" onclick="updateInputDeterminant()">Calcular Determinante</button>

                                    <div class="operations-box">
                                        <select id="operationType" class="operation-selector" onchange="updateOperationInputs()">
                                            <option value="swap">Intercambiar filas</option>
                                            <option value="multiply">Multiplicar fila por escalar</option>
                                            <option value="add">Sumar múltiplo de una fila a otra</option>
                                        </select>
                                        <div id="operationInputs" class="operation-inputs"></div>
                                        <button class="button button-secondary" onclick="applyOperation()">Aplicar Operación</button>
                                    </div>
                                </div>

                                <!-- Proceso -->
                                <div class="card">
                                    <h2 class="subtitle">Proceso de Cálculo</h2>
                                    <div class="process-section">
                                        <div id="determinantProcess" class="latex-process"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if(tool === 'determinantes5') {
                    content = `

                                 <h1 class="mb-4">Potencia de una Matriz</h1>
                                    <div class="input-group">
                                        <div class="input-field">
                                            <label class="form-label">Filas y Columnas (matriz cuadrada):</label>
                                            <input type="number" id="size" class="form-control" placeholder="Tamaño" min="1" value="2">
                                        </div>
                                        <div class="input-field">
                                            <label class="form-label">Potencia:</label>
                                            <input type="number" id="power" class="form-control" placeholder="Potencia" min="1" value="2">
                                        </div>
                                        <button class="btn btn-primary" onclick="generateMatrixInputs3()">Generar Matriz</button>
                                    </div>

                                    <div id="matrix-inputs" class="matrix-container"></div>

                                    <button class="btn btn-primary" onclick="calculatePower()">Calcular Potencia</button>

                                    <div class="latex-output">
                                        <strong>Resultado:</strong>
                                        <div id="matrix-result-latex"></div>
                                </div>                    
                
                `;
                }
                
                
                toolContent.innerHTML = content;
                
                if(tool === 'algebraLineal') {
                    this.gaussJordan.init();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                } else if(tool === 'determinantes') {
                    initializeMatrix();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }else if(tool === 'introduccion1') {
                    initializeMatrix();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }
                else if(tool === 'determinantes2') {
                    initializeMatrix();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }
                else if(tool === 'determinantes3') {
                    generateMatrixInputs1();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }
                else if(tool === 'determinantes4') {
                    generateMatrixInputs();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                    matrices.generateInputs();
                }
                else if(tool === 'determinantes5') {
                    generateMatrixInputs3();
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }
            },
            gaussJordanSidebar: () => `
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Dimensiones del Sistema</h4>
                        <div class="row mb-3">
                            <div class="col-6">
                                <input type="number" id="gjRows" class="form-control" value="3" min="2" max="10">
                            </div>
                            <div class="col-6">
                                <input type="number" id="gjCols" class="form-control" value="3" min="2" max="10">
                            </div>
                        </div>
                        <button class="btn btn-primary w-100" onclick="app.gaussJordan.updateDimensions()">Actualizar</button>
                    </div>
                </div>
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Sistema de Ecuaciones</h4>
                        <div id="gjMatrixInputs" class="mb-3"></div>
                        <button class="btn btn-primary w-100" onclick="app.gaussJordan.generateMatrix()">Generar Matriz</button>
                    </div>
                </div>
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Operaciones</h4>
                        <select id="gjOperationType" class="form-select mb-3">
                            <option value="multiply">Multiplicar fila</option>
                            <option value="add">Sumar múltiplo</option>
                            <option value="swap">Intercambiar filas</option>
                        </select>
                        <div id="gjOperationInputs"></div>
                        <button class="btn btn-success w-100" onclick="app.gaussJordan.applyOperation()">Aplicar</button>
                        <button class="btn btn-warning w-100 mt-2" onclick="app.gaussJordan.undoOperation()">Deshacer</button>
                    </div>
                </div>
            `,

            gaussJordanMainPanel: () => `
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Matriz Ampliada</h4>
                        <div id="gjAugmentedMatrix" class="gj-matrix"></div>
                    </div>
                </div>
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Matriz Actual</h4>
                        <div id="gjCurrentMatrix" class="gj-matrix"></div>
                    </div>
                </div>
                <div class="card gj-card">
                    <div class="card-body">
                        <h4>Historial</h4>
                        <pre id="gjOperationHistory" class="gj-history"></pre>
                    </div>
                </div>
            `,


            // ... (resto del código existente del objeto app)

        

            gaussJordan: {
                rows: 3,
                cols: 3,
                matrix: [],
                history: [],
                steps: [],

                init() {
                    this.renderMatrixInputs();
                    this.renderOperationButtons();
                    document.getElementById('gjOperationType').addEventListener('change', () => this.renderOperationButtons());
                },

                gcd(a, b) {
                    a = Math.abs(a);
                    b = Math.abs(b);
                    while(b) [a, b] = [b, a % b];
                    return a;
                },

                Fraction(num = 0, den = 1) {
                    const gcd = this.gcd(num, den);
                    if(den < 0) [num, den] = [-num, -den];
                    return { num: num / gcd, den: den / gcd };
                },

                parseFraction(str) {
                    if(str.includes('/')) {
                        const [num, den] = str.split('/').map(Number);
                        return this.Fraction(num, den);
                    }
                    return this.Fraction(Number(str), 1);
                },

                updateDimensions() {
                    this.rows = parseInt(document.getElementById('gjRows').value);
                    this.cols = parseInt(document.getElementById('gjCols').value);
                    this.renderMatrixInputs();
                    this.renderOperationButtons();
                },

                renderMatrixInputs() {
                    const container = document.getElementById('gjMatrixInputs');
                    container.innerHTML = '';
                    
                    for(let i = 0; i < this.rows; i++) {
                        const rowDiv = document.createElement('div');
                        rowDiv.className = 'row mb-2';
                        
                        for(let j = 0; j <= this.cols; j++) {
                            const colDiv = document.createElement('div');
                            colDiv.className = 'col';
                            
                            const input = document.createElement('input');
                            input.type = 'text';
                            input.className = 'form-control matrix-input';
                            input.value = '0';
                            input.id = `gjA${i+1}${j+1}`;
                            
                            colDiv.appendChild(input);
                            rowDiv.appendChild(colDiv);
                        }
                        container.appendChild(rowDiv);
                    }
                },

                generateMatrix() {
                    this.matrix = [];
                    for(let i = 0; i < this.rows; i++) {
                        const row = [];
                        for(let j = 0; j <= this.cols; j++) {
                            row.push(this.parseFraction(document.getElementById(`gjA${i+1}${j+1}`).value));
                        }
                        this.matrix.push(row);
                    }
                    this.steps = [JSON.parse(JSON.stringify(this.matrix))];
                    this.history = [];
                    this.updateUI();
                },

                applyOperation() {
                    const operationType = document.getElementById('gjOperationType').value;
                    
                    switch(operationType) {
                        case 'multiply':
                            const row = parseInt(document.querySelector('input[name="gjRowNum"]').value) - 1;
                            const scalar = this.parseFraction(document.getElementById('gjScalar').value);
                            this.matrix[row] = this.matrix[row].map(f => this.multiplyFractions(f, scalar));
                            this.history.push(`F${row + 1} = ${this.formatFraction(scalar)} × F${row + 1}`);
                            break;
                            
                        case 'add':
                            const source = parseInt(document.querySelector('input[name="gjSourceRow"]').value) - 1;
                            const target = parseInt(document.querySelector('input[name="gjTargetRow"]').value) - 1;
                            const multiplier = this.parseFraction(document.getElementById('gjMultiplier').value);
                            this.matrix[target] = this.matrix[target].map((f, i) => 
                                this.addFractions(f, this.multiplyFractions(this.matrix[source][i], multiplier)));
                            this.history.push(`F${target + 1} = F${target + 1} + ${this.formatFraction(multiplier)} × F${source + 1}`);
                            break;
                            
                        case 'swap':
                            const row1 = parseInt(document.querySelector('input[name="gjRow1"]').value) - 1;
                            const row2 = parseInt(document.querySelector('input[name="gjRow2"]').value) - 1;
                            [this.matrix[row1], this.matrix[row2]] = [this.matrix[row2], this.matrix[row1]];
                            this.history.push(`Intercambio F${row1 + 1} ↔ F${row2 + 1}`);
                            break;
                    }
                    
                    this.steps.push(JSON.parse(JSON.stringify(this.matrix)));
                    this.updateUI();
                },

                multiplyFractions(f1, f2) {
                    return this.Fraction(f1.num * f2.num, f1.den * f2.den);
                },

                addFractions(f1, f2) {
                    return this.Fraction(
                        f1.num * f2.den + f2.num * f1.den,
                        f1.den * f2.den
                    );
                },

                undoOperation() {
                    if(this.steps.length > 1) {
                        this.steps.pop();
                        this.matrix = JSON.parse(JSON.stringify(this.steps[this.steps.length - 1]));
                        this.history.pop();
                        this.updateUI();
                    }
                },

                renderOperationButtons() {
                    const container = document.getElementById('gjOperationInputs');
                    container.innerHTML = '';
                    const type = document.getElementById('gjOperationType').value;
                    
                    if(type === 'multiply') {
                        container.innerHTML = `
                            <div class="mb-3">
                                <label>Fila a multiplicar:</label>
                                <div id="gjRowButtons"></div>
                                <input type="hidden" name="gjRowNum">
                            </div>
                            <div class="mb-3">
                                <label>Escalar:</label>
                                <input type="text" id="gjScalar" class="form-control" value="1">
                            </div>
                        `;
                        this.renderRowButtons('gjRowButtons', 'gjRowNum');
                    }
                    else if(type === 'add') {
                        container.innerHTML = `
                            <div class="mb-3">
                                <label>Fila fuente:</label>
                                <div id="gjSourceButtons"></div>
                                <input type="hidden" name="gjSourceRow">
                            </div>
                            <div class="mb-3">
                                <label>Fila destino:</label>
                                <div id="gjTargetButtons"></div>
                                <input type="hidden" name="gjTargetRow">
                            </div>
                            <div class="mb-3">
                                <label>Multiplicador:</label>
                                <input type="text" id="gjMultiplier" class="form-control" value="1">
                            </div>
                        `;
                        this.renderRowButtons('gjSourceButtons', 'gjSourceRow');
                        this.renderRowButtons('gjTargetButtons', 'gjTargetRow');
                    }
                    else if(type === 'swap') {
                        container.innerHTML = `
                            <div class="mb-3">
                                <label>Fila 1:</label>
                                <div id="gjRow1Buttons"></div>
                                <input type="hidden" name="gjRow1">
                            </div>
                            <div class="mb-3">
                                <label>Fila 2:</label>
                                <div id="gjRow2Buttons"></div>
                                <input type="hidden" name="gjRow2">
                            </div>
                        `;
                        this.renderRowButtons('gjRow1Buttons', 'gjRow1');
                        this.renderRowButtons('gjRow2Buttons', 'gjRow2');
                    }
                },

                renderRowButtons(containerId, inputName) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = '';
                    
                    for(let i = 1; i <= this.rows; i++) {
                        const btn = document.createElement('button');
                        btn.type = 'button';
                        btn.className = 'btn btn-secondary btn-sm me-2 mb-2';
                        btn.textContent = `F${i}`;
                        btn.onclick = () => document.querySelector(`input[name="${inputName}"]`).value = i;
                        container.appendChild(btn);
                    }
                },

                formatFraction(f) {
                    return f.den === 1 ? f.num.toString() : `${f.num}/${f.den}`;
                },

                matrixToLatex(matrix) {
                    let latex = '\\begin{pmatrix}\n';
                    matrix.forEach(row => {
                        latex += row.map(f => this.formatFraction(f)).join(' & ');
                        latex += ' \\\\ \n';
                    });
                    return latex + '\\end{pmatrix}';
                },

                updateUI() {
                    document.getElementById('gjCurrentMatrix').innerHTML = 
                        `$$${this.matrixToLatex(this.matrix)}$$`;
                    document.getElementById('gjAugmentedMatrix').innerHTML = 
                        `$$${this.matrixToLatex(this.steps[0])}$$`;
                    document.getElementById('gjOperationHistory').textContent = 
                        this.history.join('\n') || 'No hay operaciones realizadas';
                    MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
                }
            }
        };    





        

        // Código de la aplicación de cálculo de determinantes
        let matrix = [];
        let history = [];
        let determinantMultiplier = 1;
        let matrixSize = 2;
        let initialDeterminant = 0;
        let currentDeterminant = 0;

        function initializeMatrix() {
            matrix = Array(matrixSize).fill().map(() => Array(matrixSize).fill(0));
            document.documentElement.style.setProperty('--matrix-size', matrixSize);
            history = [];
            determinantMultiplier = 1;
            renderMatrix();
            updateOperationInputs();
        }

        function updateSize() {
            const newSize = parseInt(document.getElementById('matrixSize').value);
            if (newSize >= 2 && newSize <= 5) {
                matrixSize = newSize;
                initializeMatrix();
            } else {
                alert('El tamaño debe estar entre 2 y 5');
            }
        }

        function resetMatrix() {
            initializeMatrix();
            history = [];
            determinantMultiplier = 1;
            currentDeterminant = 0;
            initialDeterminant = 0;
            updateLatexDeterminant();
        }

        function renderMatrix() {
            const container = document.getElementById('matrixInput');
            container.innerHTML = '';
            
            for (let i = 0; i < matrixSize; i++) {
                const row = document.createElement('div');
                row.className = 'matrix-row';
                
                for (let j = 0; j < matrixSize; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'matrix-cell';
                    
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'number-input';
                    input.value = matrix[i][j] || '';
                    input.placeholder = '0';
                    
                    input.onchange = (e) => {
                        const value = parseNumberInput(e.target.value);
                        matrix[i][j] = value;
                    };
                    
                    cell.appendChild(input);
                    row.appendChild(cell);
                }
                container.appendChild(row);
            }
        }

        function parseNumberInput(input) {
            input = input.trim();
            
            if (input.includes('/')) {
                const [num, den] = input.split('/').map(x => parseFloat(x.trim()));
                if (!isNaN(num) && !isNaN(den) && den !== 0) {
                    return num / den;
                }
            }
            
            const num = parseFloat(input);
            return isNaN(num) ? 0 : num;
        }

        function formatNumber(num) {
            if (Number.isInteger(num)) {
                return num.toString();
            }
            
            const fraction = toFraction(num);
            if (fraction) {
                return fraction;
            }
            
            return num.toFixed(2);
        }

        function toFraction(decimal) {
            const tolerance = 1.0E-10;
            let h1 = 1;
            let h2 = 0;
            let k1 = 0;
            let k2 = 1;
            let b = decimal;
            
            do {
                let a = Math.floor(b);
                let aux = h1;
                h1 = a * h1 + h2;
                h2 = aux;
                aux = k1;
                k1 = a * k1 + k2;
                k2 = aux;
                b = 1 / (b - a);
            } while (Math.abs(decimal - h1 / k1) > decimal * tolerance && b !== Infinity);

            if (k1 < 100) {
                return k1 === 1 ? h1.toString() : `\\frac{${h1}}{${k1}}`;
            }
            
            return null;
        }

        function calculateDeterminant(mat) {
            if (matrixSize === 1) {
                return mat[0][0];
            }
            
            if (matrixSize === 2) {
                return (mat[0][0] * mat[1][1]) - (mat[0][1] * mat[1][0]);
            }
            
            let det = 0;
            for (let i = 0; i < matrixSize; i++) {
                let subMatrix = [];
                for (let j = 1; j < matrixSize; j++) {
                    let row = [];
                    for (let k = 0; k < matrixSize; k++) {
                        if (k !== i) row.push(mat[j][k]);
                    }
                    subMatrix.push(row);
                }
                det += mat[0][i] * Math.pow(-1, i) * calculateDeterminant(subMatrix);
            }
            return det;
        }

        function updateLatexDeterminant() {
            const processDiv = document.getElementById('determinantProcess');
            let processLatex = '';
            
            processLatex += '\\begin{align*}\n';
            processLatex += 'A &= \\begin{vmatrix}\n';
            for (let i = 0; i < matrixSize; i++) {
                processLatex += matrix[i].map(val => formatNumber(val)).join(' & ');
                if (i < matrixSize - 1) processLatex += ' \\\\\n';
            }
            processLatex += '\\end{vmatrix}\n';

            history.forEach((step) => {
                if (step.matrix) {
                    processLatex += '&= \\begin{vmatrix}\n';
                    for (let i = 0; i < matrixSize; i++) {
                        processLatex += step.matrix[i].map(val => formatNumber(val)).join(' & ');
                        if (i < matrixSize - 1) processLatex += ' \\\\\n';
                    }

                    processLatex += '\\end{vmatrix}';

                    if (step.operation) {
                        processLatex += '\\quad \\text{' + step.operation + '}';
                    }

                    processLatex += '\\\\\n';
                }
            });

            if (currentDeterminant !== 0 || initialDeterminant !== 0) {
                // Mostrar el resultado parcial si hay un multiplicador
                if (determinantMultiplier !== 1) {
                    processLatex += '&= ' + determinantMultiplier + ' \\cdot ' + 
                                   formatNumber(currentDeterminant/determinantMultiplier) + '\\\\\n';
                }
                // Mostrar el resultado final
                processLatex += '&= ' + formatNumber(currentDeterminant) + '\n';
            }
            
            processLatex += '\\end{align*}';
            
            processDiv.innerHTML = processLatex;
            MathJax.Hub.Queue(["Typeset", MathJax.Hub, processDiv]);
        }

        function updateOperationInputs() {
            const container = document.getElementById('operationInputs');
            const operationType = document.getElementById('operationType').value;
            
            let html = '';
            const rowOptions = Array.from({length: matrixSize}, (_, i) => 
                `<option value="${i}">Fila ${i + 1}</option>`
            ).join('');
            
            switch (operationType) {
                case 'swap':
                    html = `
                        <div>
                            <label>Fila 1:</label>
                            <select class="operation-selector" id="row1">${rowOptions}</select>
                        </div>
                        <div>
                            <label>Fila 2:</label>
                            <select class="operation-selector" id="row2">${rowOptions}</select>
                        </div>
                    `;
                    break;
                
                case 'multiply':
                    html = `
                        <div>
                            <label>Fila a multiplicar:</label>
                            <select class="operation-selector" id="rowToMultiply">${rowOptions}</select>
                        </div>
                        <div>
                            <label>Escalar:</label>
                            <input type="text" class="number-input" id="scalar" placeholder="Ingrese un número">
                        </div>
                    `;
                    break;
                
                case 'add':
                    html = `
                        <div>
                            <label>Fila destino:</label>
                            <select class="operation-selector" id="targetRow">${rowOptions}</select>
                        </div>
                        <div>
                            <label>Fila fuente:</label>
                            <select class="operation-selector" id="sourceRow">${rowOptions}</select>
                        </div>
                        <div>
                            <label>Escalar:</label>
                            <input type="text" class="number-input" id="addScalar" placeholder="Ingrese un número">
                        </div>
                    `;
                    break;
            }
            
            container.innerHTML = html;
        }

        function applyOperation() {
            const operationType = document.getElementById('operationType').value;
            let operationDescription = '';

            try {
                switch (operationType) {
                    case 'swap':
                        const row1 = parseInt(document.getElementById('row1').value);
                        const row2 = parseInt(document.getElementById('row2').value);
                        if (row1 === row2) throw new Error('No puedes intercambiar una fila consigo misma.');
                        swapRows(row1, row2);
                        operationDescription = `F${row1 + 1} ↔ F${row2 + 1}`;
                        break;

                    case 'multiply':
                        const rowToMultiply = parseInt(document.getElementById('rowToMultiply').value);
                        const scalar = parseNumberInput(document.getElementById('scalar').value);
                        if (isNaN(scalar)) throw new Error('El escalar debe ser un número válido.');
                        multiplyRow(rowToMultiply, scalar);
                        operationDescription = `${scalar} × F${rowToMultiply + 1}`;
                        break;

                    case 'add':
                        const targetRow = parseInt(document.getElementById('targetRow').value);
                        const sourceRow = parseInt(document.getElementById('sourceRow').value);
                        const addScalar = parseNumberInput(document.getElementById('addScalar').value);
                        if (isNaN(addScalar)) throw new Error('El escalar debe ser un número válido.');
                        addRow(targetRow, sourceRow, addScalar);
                        operationDescription = `F${targetRow + 1} + ${addScalar} × F${sourceRow + 1}`;
                        break;
                }

                history.push({ matrix: matrix.map(row => [...row]), operation: operationDescription });
                updateLatexDeterminant();
            } catch (error) {
                alert(error.message);
            }
        }

        function swapRows(row1, row2) {
            [matrix[row1], matrix[row2]] = [matrix[row2], matrix[row1]];
            determinantMultiplier *= -1;
        }

        function multiplyRow(row, scalar) {
            matrix[row] = matrix[row].map(val => val * scalar);
            determinantMultiplier *= scalar;
        }

        function addRow(targetRow, sourceRow, scalar) {
            matrix[targetRow] = matrix[targetRow].map((val, i) => val + scalar * matrix[sourceRow][i]);
        }

        function updateInputDeterminant() {
            initialDeterminant = calculateDeterminant(matrix);
            currentDeterminant = initialDeterminant * determinantMultiplier;
            updateLatexDeterminant();
        }

        // Inicializar la matriz al cargar la página
        

        //

        function generateMatrixInputs() {
            const rowsA = parseInt(document.getElementById('rowsA').value);
            const colsA = parseInt(document.getElementById('colsA').value);
            const rowsB = parseInt(document.getElementById('rowsB').value);
            const colsB = parseInt(document.getElementById('colsB').value);

            if (colsA !== rowsB) {
                alert("El número de columnas de A debe ser igual al número de filas de B.");
                return;
            }

            let inputsHTML = "<h3>Matriz A</h3><div class='matrix-container'>";
            for (let i = 0; i < rowsA; i++) {
                inputsHTML += "<div class='matrix-row'>";
                for (let j = 0; j < colsA; j++) {
                    inputsHTML += `<div class='matrix-cell'><input type="number" id="matrixA-${i}-${j}" placeholder="A[${i+1},${j+1}]"></div>`;
                }
                inputsHTML += "</div>";
            }
            inputsHTML += "</div>";

            inputsHTML += "<h3>Matriz B</h3><div class='matrix-container'>";
            for (let i = 0; i < rowsB; i++) {
                inputsHTML += "<div class='matrix-row'>";
                for (let j = 0; j < colsB; j++) {
                    inputsHTML += `<div class='matrix-cell'><input type="number" id="matrixB-${i}-${j}" placeholder="B[${i+1},${j+1}]"></div>`;
                }
                inputsHTML += "</div>";
            }
            inputsHTML += "</div>";

            document.getElementById('matrix-inputs').innerHTML = inputsHTML;
        }

        function calculateProduct() {
            const rowsA = parseInt(document.getElementById('rowsA').value);
            const colsA = parseInt(document.getElementById('colsA').value);
            const rowsB = parseInt(document.getElementById('rowsB').value);
            const colsB = parseInt(document.getElementById('colsB').value);

            if (colsA !== rowsB) {
                alert("El número de columnas de A debe ser igual al número de filas de B.");
                return;
            }

            let matrixA = [];
            let matrixB = [];
            for (let i = 0; i < rowsA; i++) {
                matrixA[i] = [];
                for (let j = 0; j < colsA; j++) {
                    matrixA[i][j] = parseFloat(document.getElementById(`matrixA-${i}-${j}`).value) || 0;
                }
            }
            for (let i = 0; i < rowsB; i++) {
                matrixB[i] = [];
                for (let j = 0; j < colsB; j++) {
                    matrixB[i][j] = parseFloat(document.getElementById(`matrixB-${i}-${j}`).value) || 0;
                }
            }

            let productMatrix = Array.from({ length: rowsA }, () =>
                Array.from({ length: colsB }, () => 0)
            );

            for (let i = 0; i < rowsA; i++) {
                for (let j = 0; j < colsB; j++) {
                    for (let k = 0; k < colsA; k++) {
                        productMatrix[i][j] += matrixA[i][k] * matrixB[k][j];
                    }
                }
            }

        // Mostrar resultado en LaTeX
        const latexMatrixA = matrixToLatex(matrixA);
        const latexMatrixB = matrixToLatex(matrixB);
        const latexProduct = matrixToLatex(productMatrix);

            document.getElementById('matrix-product-latex').innerHTML = `
                \\[
                    \\begin{pmatrix}
                        ${matrixA.map(row => row.join(' & ')).join(' \\\\ ')}
                    \\end{pmatrix}
                    \\times
                    \\begin{pmatrix}
                        ${matrixB.map(row => row.join(' & ')).join(' \\\\ ')}
                    \\end{pmatrix}
                    =
                    \\begin{pmatrix}
                        ${productMatrix.map(row => row.join(' & ')).join(' \\\\ ')}
                    \\end{pmatrix}
                \\]
            `;
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }

        function matrixToLatex(matrix) {
            return `\\begin{pmatrix}
                ${matrix.map(row => row.join(' & ')).join(' \\\\ ')}
            \\end{pmatrix}`;
        }

        //////////////////////////////////////////////////////////////////////////

        function generateMatrixInputs1() {
            const rows = parseInt(document.getElementById('rows').value);
            const cols = parseInt(document.getElementById('cols').value);
    
            let inputsHTML = "<h3>Matriz A</h3><div class='matrix-container'>";
            for (let i = 0; i < rows; i++) {
                inputsHTML += "<div class='matrix-row'>";
                for (let j = 0; j < cols; j++) {
                    inputsHTML += `<div class='matrix-cell'><input type="number" id="matrixA-${i}-${j}" placeholder="A[${i+1},${j+1}]"></div>`;
                }
                inputsHTML += "</div>";
            }
            inputsHTML += "</div>";
    
            inputsHTML += "<h3>Matriz B</h3><div class='matrix-container'>";
            for (let i = 0; i < rows; i++) {
                inputsHTML += "<div class='matrix-row'>";
                for (let j = 0; j < cols; j++) {
                    inputsHTML += `<div class='matrix-cell'><input type="number" id="matrixB-${i}-${j}" placeholder="B[${i+1},${j+1}]"></div>`;
                }
                inputsHTML += "</div>";
            }
            inputsHTML += "</div>";
    
            document.getElementById('matrix-inputs').innerHTML = inputsHTML;
        }
        

        function calculateSum() {
            const rows = parseInt(document.getElementById('rows').value);
            const cols = parseInt(document.getElementById('cols').value);
            const scalarA = parseFloat(document.getElementById('scalarA').value) || 1;
            const scalarB = parseFloat(document.getElementById('scalarB').value) || 1;

            let matrixA = [];
            let matrixB = [];
            for (let i = 0; i < rows; i++) {
                matrixA[i] = [];
                matrixB[i] = [];
                for (let j = 0; j < cols; j++) {
                    matrixA[i][j] = parseFloat(document.getElementById(`matrixA-${i}-${j}`).value) || 0;
                    matrixB[i][j] = parseFloat(document.getElementById(`matrixB-${i}-${j}`).value) || 0;
                }
            }

            let scaledMatrixA = matrixA.map(row => row.map(value => value * scalarA));
            let scaledMatrixB = matrixB.map(row => row.map(value => value * scalarB));
            let sumMatrix = scaledMatrixA.map((row, i) => 
                row.map((val, j) => val + scaledMatrixB[i][j])
            );

            const latexOutput = `\\begin{align*}
                & \\textbf{Matrices originales:} \\\\
                & A = \\begin{bmatrix}
                    ${matrixA.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix} \\qquad
                B = \\begin{bmatrix}
                    ${matrixB.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix} \\\\[1em]
                & \\textbf{Matrices escaladas:} \\\\
                & ${scalarA}A = \\begin{bmatrix}
                    ${scaledMatrixA.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix} \\qquad
                ${scalarB}B = \\begin{bmatrix}
                    ${scaledMatrixB.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix} \\\\[1em]
                & \\textbf{Resultado final:} \\\\
                & ${scalarA}A + ${scalarB}B = \\begin{bmatrix}
                    ${sumMatrix.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix}
            \\end{align*}`;

            document.getElementById('matrix-result-latex').innerHTML = latexOutput;
            MathJax.Hub.Queue(["Typeset", MathJax.Hub, "matrix-result-latex"]);
        }








        ///////////////////////////////////////////////////////////////////////////

        function generateMatrixInputs3() {
            const size = parseInt(document.getElementById('size').value);
            let inputsHTML = "<h3>Matriz</h3><div class='matrix-container'>";
            
            for (let i = 0; i < size; i++) {
                inputsHTML += "<div class='matrix-row'>";
                for (let j = 0; j < size; j++) {
                    inputsHTML += `<div class='matrix-cell'>
                        <input type="number" id="matrix-${i}-${j}" placeholder="M[${i+1},${j+1}]">
                    </div>`;
                }
                inputsHTML += "</div>";
            }
            inputsHTML += "</div>";
            
            document.getElementById('matrix-inputs').innerHTML = inputsHTML;
        }

        function calculatePower() {
            const size = parseInt(document.getElementById('size').value);
            const power = parseInt(document.getElementById('power').value);

            // Obtener matriz inicial
            let matrix = [];
            for (let i = 0; i < size; i++) {
                matrix[i] = [];
                for (let j = 0; j < size; j++) {
                    matrix[i][j] = parseFloat(document.getElementById(`matrix-${i}-${j}`).value) || 0;
                }
            }

            // Calcular potencia
            let resultMatrix = matrixPower(matrix, power);

            // Generar LaTeX
            const latexOutput = `\\[
                \\begin{array}{l}
                \\textbf{Matriz original:} \\\\
                M = \\begin{bmatrix}
                ${matrix.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix} \\\\[1em]
                \\textbf{Resultado:} \\\\
                M^{${power}} = \\begin{bmatrix}
                ${resultMatrix.map(row => row.join(' & ')).join(' \\\\ ')}
                \\end{bmatrix}
                \\end{array}
            \\]`;

            // Mostrar resultado
            document.getElementById('matrix-result-latex').innerHTML = latexOutput;
            MathJax.Hub.Queue(["Typeset", MathJax.Hub, "matrix-result-latex"]);
        }

        function multiplyMatrices(a, b) {
            const rowsA = a.length;
            const colsA = a[0].length;
            const rowsB = b.length;
            const colsB = b[0].length;

            if (colsA !== rowsB) {
                throw new Error("No se pueden multiplicar las matrices: dimensiones incompatibles.");
            }

            let result = Array.from({ length: rowsA }, () =>
                Array.from({ length: colsB }, () => 0)
            );

            for (let i = 0; i < rowsA; i++) {
                for (let j = 0; j < colsB; j++) {
                    for (let k = 0; k < colsA; k++) {
                        result[i][j] += a[i][k] * b[k][j];
                    }
                }
            }

            return result;
        }

        function matrixPower(matrix, power) {
            if (power === 0) {
                // Devolver matriz identidad
                return matrix.map((row, i) => 
                    row.map((_, j) => i === j ? 1 : 0)
                );
            }
            
            let result = matrix;
            for (let p = 1; p < power; p++) {
                result = multiplyMatrices(result, matrix);
            }
            return result;
        }

        //////////////////////////////////////////////////////////////////////////

        // Inicialización
        initializeMatrix();
        
        document.addEventListener('DOMContentLoaded', () => {
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [['$', '$']],
                    displayMath: [['$$', '$$']]
                }
            });


            // Generar matrices iniciales
            matrices.generateInputs();

            // Inicializar Gauss-Jordan
            gauss.renderInputs();
            gauss.renderOperationInputs();

            // Event listeners
            document.getElementById('operationType')?.addEventListener('change', () => gauss.renderOperationInputs());

            // Matrix dimension change handlers
            ['A', 'B'].forEach((matrix, index) => {
                const nextMatrix = ['B', 'C'][index];
                document.getElementById(`cols${matrix}`).addEventListener('change', () => {
                    document.getElementById(`rows${nextMatrix}`).value = 
                        document.getElementById(`cols${matrix}`).value;
                    matrices.generateInputs();
                });
            });

            ['A', 'B', 'C'].forEach(matrix => {
                ['rows', 'cols'].forEach(dim => {
                    document.getElementById(`${dim}${matrix}`).addEventListener('change', () => matrices.generateInputs());
                });
            });
        });


    </script>

    <script type="module">
        import Chatbot from "https://cdn.jsdelivr.net/npm/flowise-embed/dist/web.js"
        Chatbot.init({
            chatflowid: "96460740-d404-417e-8c57-09930daa8ec6",
            apiHost: "https://flowiseai-railway-production-9c6d7.up.railway.app",
        })
    </script>

</body>
</html>